- hosts: ec2
  become: yes
  gather_facts: no
  vars:
    ansible_python_interpreter: /usr/bin/python3

  tasks:
    - name: Ensure Python 3 is installed
      raw: test -e /usr/bin/python3 || (sudo yum install -y python3)
      changed_when: false

    - name: Re-enable fact gathering
      setup:

    - name: Instalar pacotes básicos
      yum:
        name:
          - python3
          - python3-pip
        state: present

    - name: Instalar bibliotecas Python
      pip:
        name:
          - boto3
          - pandas

    - name: Criar diretórios de dados
      file:
        path: "/data/{{ item }}"
        state: directory
      loop:
        - raw
        - trusted
        - client

